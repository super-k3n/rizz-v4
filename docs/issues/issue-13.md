# イシュータイトル
ユーザーのパスワード再設定機能の実装

## 概要
現状、ユーザーがパスワードを忘れた場合やセキュリティ上の理由でパスワードを変更したい場合に、アプリ上からパスワードを再設定する手段がありません。Supabase Authの機能を活用し、ユーザーが自身でパスワードをリセットできる仕組みを実装します。これにより、ユーザー体験の向上とセキュリティ強化を図ります。

## 実施内容

### パート1: バックエンド・認証基盤
- [ ] Supabase Authのパスワードリセット機能の有効化
- [ ] パスワードリセット用メールテンプレートの確認・カスタマイズ
- [ ] セキュリティ要件の確認（トークン有効期限、リクエスト回数制限など）

### パート2: API・フロントエンド実装
- [ ] パスワードリセットリクエスト画面の作成
  - [ ] メールアドレス入力フォーム
  - [ ] バリデーションの実装
  - [ ] 送信完了メッセージの表示
- [ ] パスワード再設定画面の作成
  - [ ] 新しいパスワード入力フォーム
  - [ ] パスワード強度チェック
  - [ ] 再設定完了メッセージの表示
- [ ] Supabase APIとの連携
  - [ ] パスワードリセットメール送信APIの呼び出し
  - [ ] パスワード再設定APIの呼び出し
- [ ] エラーハンドリングの実装

### パート3: UI/UX・状態管理
- [ ] 既存のUIに合わせたデザイン適用
- [ ] ローディング・エラー・成功状態の管理
- [ ] 不正なトークンや期限切れ時のガイダンス表示

## 参照資料
- [Supabase Auth公式ドキュメント](https://supabase.com/docs/guides/auth)
- [@003_api.md](API設計書)
- [@250424-11.md](日次目標の日付別管理機能の実装ログ)

## 完了条件
- [ ] ユーザーがメールアドレスを入力してパスワードリセットメールを受け取れること
- [ ] メール内リンクから新しいパスワードを設定できること
- [ ] バリデーション・エラーハンドリングが適切に機能すること
- [ ] セキュリティ要件（トークン有効期限・リクエスト制限等）が満たされていること
- [ ] 既存のUI/UXに違和感なく統合されていること

## 実装方針

### 認証・セキュリティ設計
- Supabase Authの標準機能を利用
- パスワードリセットトークンの有効期限・リクエスト回数制限を確認
- メールテンプレートのカスタマイズ（ブランド名・サポート連絡先等）

### 型定義例
```typescript
interface PasswordResetRequest {
  email: string;
}

interface PasswordResetSubmit {
  newPassword: string;
  token: string;
}
```

### バリデーションスキーマ例
```typescript
const passwordResetRequestSchema = Yup.object().shape({
  email: Yup.string()
    .email('有効なメールアドレスを入力してください')
    .required('メールアドレスは必須です'),
});

const passwordResetSubmitSchema = Yup.object().shape({
  newPassword: Yup.string()
    .min(8, '8文字以上で入力してください')
    .required('新しいパスワードは必須です'),
  token: Yup.string().required(),
});
```

### エラーハンドリング
- メールアドレス未登録時のメッセージ
- トークン無効・期限切れ時のガイダンス
- ネットワークエラー時のリトライ案内

### UI/UX方針
- 既存のUIコンポーネント・レイアウトを踏襲
- 送信・再設定完了時の明確なフィードバック
- エラー時のユーザーガイダンスを充実
